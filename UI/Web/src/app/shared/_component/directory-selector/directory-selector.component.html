<div
  class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"
  (click)="closeDialog()"
>
  <div
    class="relative bg-white dark:bg-gray-600 p-6 rounded-lg w-11/12 sm:w-96 md:w-1/3 lg:w-1/4 space-y-4"
    (click)="$event.stopPropagation()"
    [ngClass]="{ 'top-auto': isMobile, 'mt-10': !isMobile }"
  >
    <div class="flex flex-col py-5">
      <h1 class="text-xl text-black dark:text-white mb-2">
        Selected: <span class="font-mono">{{ routeStack.items.join('/') }}</span>
      </h1>

      @if (filter) {
        <input
          class="mb-2 w-full p-1 rounded-lg border focus:ring-primary-600 focus:border-primary-600 bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500 sm:text-sm"
          type="text"
          placeholder="Filter..."
          (input)="onFilterChange($event)"
        />
      }

      <div class="flex flex-col max-h-48 overflow-auto space-y-2 mb-2">
        @if (currentRoot !== root) {
          <div
            class="flex items-center space-x-2 p-2 rounded-lg border bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:border-gray-600 dropdown-item"
          >
            <ng-icon name="heroFolder" size="16"></ng-icon>
            <span
              class="w-full text-left hover:underline hover:cursor-pointer"
              (click)="goBack()"
            >...</span>
          </div>
        }

        @if (getEntries().length > 0) {
          <div class="flex flex-col space-y-2">
            @for (entry of getEntries(); track $index) {
              <div
                class="flex items-center space-x-2 p-2 rounded-lg border bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:border-gray-600 dropdown-item"
              >
                <ng-icon name="{{ entry.dir ? 'heroFolder' : 'heroDocument' }}" size="16"></ng-icon>
                <span
                  class="w-full font-bold text-left {{ entry.dir ? 'hover:underline hover:cursor-pointer' : '' }}"
                  (click)="selectNode(entry)"
                >{{ entry.name }}</span>

                <!-- Copy Path Icon (if copy is enabled) -->
                @if (copy) {
                  <ng-icon
                    name="heroClipboard"
                    size="16"
                    class="hover:cursor-pointer"
                    (click)="copyPath(entry)"
                  ></ng-icon>
                }
              </div>
            }
          </div>
        }
      </div>

      @if (create) {
        <div class="flex items-center space-x-2">
          <input
            class="w-full p-1 rounded-lg border focus:ring-primary-600 focus:border-primary-600 bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500 sm:text-sm"
            type="text"
            placeholder="Create"
            [(ngModel)]="newDirName"
            (input)="onNewDirNameChange($event)"
          />
          <ng-icon
            class="text-black dark:text-white hover:cursor-pointer"
            name="heroPlus"
            size="16"
            (click)="createNew()"
          ></ng-icon>
        </div>
      }
    </div>

    <!-- Action Buttons -->
    <div class="flex justify-between space-x-4">
      <button
        (click)="confirm()"
        class="px-4 py-2 bg-gradient-to-r from-green-500 to-green-700 text-white rounded-lg shadow-md hover:from-green-600 hover:to-green-800 focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-offset-2 hover:cursor-pointer"
      >
        Select
      </button>
      <button
        (click)="closeDialog()"
        class="px-4 py-2 bg-gradient-to-r from-red-500 to-red-700 text-white rounded-lg shadow-md hover:from-red-600 hover:to-red-800 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 hover:cursor-pointer"
      >
        Cancel
      </button>
    </div>
  </div>
</div>
